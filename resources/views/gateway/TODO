TODO add support for virtual gateways